<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="chef">
	<!-- 가입 -->
	<select id="insertOfChef" parameterType="chef_dto">
		insert into chef values (#{name},#{email},#{pass},#{nickname},#{profile},#{hp},now(),0,0,0)
	</select>
	<!-- 로그인, 탈퇴시 비번확인 -->
	<select id="login" parameterType="HashMap" resultType="int">
		select count(*) from chef where email=#{email} and pass=#{pass}
	</select>
	<!-- 탈퇴 -->
	<delete id="deleteOfChef" parameterType="String">
		delete from chef where email=#{email}
	</delete>
	<!-- 탈퇴 DB에 저장 -->
	<insert id="insertWithdraw" parameterType="String">
		insert into withdraw (email,name,hp) (select email,name,hp from chef where email=#{email})
	</insert>
	<update id="updateWithdraw" parameterType="HashMap">
		update withdraw set withdrawdate=now(), reason=#{reason} where email=#{email}
	</update>
	
	<select id="getDataOfChef" parameterType="String" resultType="chef_dto">
		select * from chef where email=#{email}
	</select>
	<!-- 일반정보 수정 -->
	<update id="updateNormalinfoOfChef" parameterType="chef_dto">
		update chef set name=#{name},nickname=#{nickname},profile=#{profile},hp=#{hp} where email=#{email}
	</update>
	<!-- 기존 프로필사진 이름 -->
	<select id="getprofile" resultType="String">
		select profile from chef where email=#{email}
	</select>
	<!-- 비밀번호 수정 -->
	<update id="updatePassOfChef" parameterType="HashMap">
		update chef set pass=#{newpass} where email=#{email} and pass=#{pass}
	</update>
	<!-- 아이디 중복체크 -->
	<select id="checkEmailOfChef" parameterType="String" resultType="int">
		select count(*) from chef where email=#{email}
	</select>
	<!-- 닉네임 중복체크 -->
	<select id="checkNickOfChef" parameterType="String" resultType="int">
		select count(*) from chef where nickname=#{nickname}
	</select>
	<!-- 아이디 찾기 -->
	<select id="findIdOfChef" parameterType="HashMap" resultType="String">
		select email from chef where name=#{name} and hp=#{hp}
	</select>
	<!-- 비번찾기 -->
	<select id="findPassOfChef" parameterType="HashMap" resultType="String">
		select pass from chef where name=#{name} and email=#{email}
	</select>
	<!-- 닉네임 -->
	<select id="getNickname" parameterType="String" resultType="String">
		select nickname from chef where email=#{email}
	</select>
</mapper>

	<!-- 페이징처리 LIST -->
	<!-- <select id="" parameterType="HashMap" resultType="">
		<![CDATA[
	 		select a.* from (select rownum rnum,b.* from
	 		(select * from 테이블명 order by num desc)b)a
	 		where a.rnum>=#{start} and a.rnum<=#{end}
	 	]]>
	</select> -->